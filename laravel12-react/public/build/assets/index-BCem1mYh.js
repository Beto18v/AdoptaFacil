import{K as se,r as l,j as e,L as te,S as U}from"./app-C9a0Z2GV.js";import{T as le}from"./theme-switcher-D1-KvWmV.js";import{B as ie}from"./badge-BgUZm6Q0.js";import{B as i}from"./button-Cd7vGOiK.js";import{C as $}from"./checkbox-BcreT0B1.js";import{D as A,a as de,b as D,c as F,d as R,e as ne}from"./dialog-BgfS5c9J.js";import{I as h}from"./input-DOoS4fzs.js";import{L as d}from"./label-CyhaV5PO.js";import{S as O,a as z,b as L,c as M,d as o}from"./select-BInn26Nf.js";import{T as oe,a as ce,b as H,c as b,d as ge,e as y}from"./table-VTONTYtq.js";import{T as me}from"./textarea-DiWvSn8D.js";import{A as xe}from"./app-layout-BiuVrvCM.js";import{M as he}from"./mail-BB1YT8ZW.js";import{P as pe}from"./plus-B82hh39Z.js";import{c as ue}from"./createLucideIcon-CDVaj1tW.js";import{T as be}from"./trash-2-C3AMxhCd.js";import{U as ye}from"./user-JEmZ2skp.js";import"./index-wTHh6_rQ.js";import"./index-BT6umcoc.js";import"./index-DK3AijET.js";import"./avatar-utils-DC3zEnz9.js";import"./x-CWg9G-ba.js";import"./index-D-6MT3mC.js";import"./avatar-DfpzBFwZ.js";import"./Logo-BWfBvknf.js";import"./LogoWhite-CZ6C_-JM.js";import"./chevron-right-BY3h9dfG.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ke=ue("SquarePen",je),ve=[{title:"Gestión de Usuarios",href:route("gestion.usuarios")}];function Ye(){const{usuarios:j,errors:s}=se().props,[w,G]=l.useState("all"),[m,P]=l.useState([]),[I,C]=l.useState(!1),[q,k]=l.useState(!1),[t,p]=l.useState(null),[c,u]=l.useState({name:"",email:"",password:"",role:"cliente"}),[_,v]=l.useState(!1),[f,B]=l.useState(""),[N,V]=l.useState(""),[S,J]=l.useState([]),[E,K]=l.useState(!1),x=w==="all"?j:j.filter(a=>a.role===w),Y=a=>{P(g=>g.includes(a)?g.filter(r=>r!==a):[...g,a])},Q=()=>{P(m.length===x.length?[]:x.map(a=>a.id))},W=()=>{U.post(route("gestion.usuarios.store"),c,{onSuccess:()=>{C(!1),u({name:"",email:"",password:"",role:"cliente"})}})},X=a=>{p(a),k(!0)},Z=()=>{t&&U.put(route("gestion.usuarios.update",t.id),{name:t.name,email:t.email,role:t.role},{onSuccess:()=>{k(!1),p(null)}})},ee=a=>{confirm("¿Estás seguro de eliminar este usuario?")&&U.delete(route("gestion.usuarios.destroy",a))},ae=async()=>{const g=[...m.map(r=>{const n=j.find(T=>T.id===r);return n?n.email:null}).filter(r=>r!==null),...S];try{const r=await fetch("http://localhost:8080/api/send-bulk-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emails:g,subject:f,description:N})});if(r.ok)alert("Correos enviados exitosamente"),v(!1),B(""),V(""),J([]);else{const n=await r.text();alert("Error al enviar correos: "+n)}}catch(r){alert("Error de conexión: "+r.message)}},re=(a,g)=>`
            <!DOCTYPE html>
            <html lang="es">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>${a}</title>
                <style>
                    body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 20px; }
                    .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
                    .logo { text-align: center; margin-bottom: 20px; }
                    .logo img { width: 100px; }
                    h1 { color: #4CAF50; text-align: center; }
                    p { line-height: 1.6; }
                    .cta-button { display: inline-block; background: #4CAF50; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; margin: 20px 0; }
                    footer { margin-top: 30px; font-size: 12px; color: #666; text-align: center; border-top: 1px solid #eee; padding-top: 20px; }
                </style>
            </head>
            <body>
                <div class="container">
                    <div class="logo">
                        <img src="/Logo/Logo.png" alt="AdoptaFácil Logo">
                    </div>
                    <h1>${a}</h1>
                    <p>Hola,</p>
                    <p>${g.replace(/\n/g,"<br>")}</p>
                    <p>¡Gracias por ser parte de AdoptaFácil!</p>
                    <a href="#" class="cta-button">Visitar AdoptaFácil</a>
                    <footer>
                        <p>AdoptaFácil - Conectando corazones con patitas</p>
                        <p>Si tienes alguna pregunta, contáctanos en info@adoptafacil.com</p>
                    </footer>
                </div>
            </body>
            </html>
        `;return e.jsxs(xe,{breadcrumbs:ve,children:[e.jsx(te,{title:"Gestión de Usuarios"}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gradient-to-r from-green-400 to-blue-500 p-6 dark:from-green-600 dark:to-blue-700",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Gestión de Usuarios"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(O,{value:w,onValueChange:G,children:[e.jsx(z,{className:"w-48 border-white/20 bg-white/90 text-gray-900 backdrop-blur-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",children:e.jsx(L,{placeholder:"Filtrar por rol"})}),e.jsxs(M,{children:[e.jsx(o,{value:"all",children:"Todos"}),e.jsx(o,{value:"cliente",children:"Cliente"}),e.jsx(o,{value:"aliado",children:"Aliado"}),e.jsx(o,{value:"admin",children:"Admin"})]})]})})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-white/80 dark:text-gray-200",children:[x.length," ",x.length===1?"usuario":"usuarios"]}),e.jsxs("div",{className:"flex gap-2",children:[m.length>0&&e.jsxs(i,{onClick:()=>v(!0),variant:"outline",className:"border-white/20 bg-white/90 text-gray-900 backdrop-blur-sm hover:bg-white dark:border-gray-600 dark:bg-gray-800/80 dark:text-gray-200 dark:hover:bg-gray-700/80",children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Enviar Correo (",m.length,")"]}),e.jsxs(A,{open:I,onOpenChange:C,children:[e.jsx(de,{asChild:!0,children:e.jsxs(i,{className:"bg-white text-green-600 hover:bg-gray-100 dark:bg-gray-800/90 dark:text-green-400 dark:hover:bg-gray-700/80",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Crear Usuario"]})}),e.jsxs(D,{className:"rounded-lg bg-white p-6 dark:bg-gray-800 dark:text-gray-100",children:[e.jsx(F,{children:e.jsx(R,{children:"Crear Nuevo Usuario"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(d,{htmlFor:"name",className:"text-right text-gray-700 dark:text-gray-200",children:"Nombre"}),e.jsx(h,{id:"name",value:c.name,onChange:a=>u({...c,name:a.target.value}),className:"col-span-3 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"}),(s==null?void 0:s.name)&&e.jsx("p",{className:"col-span-3 col-start-2 text-sm text-red-500 dark:text-red-400",children:s.name})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(d,{htmlFor:"email",className:"text-right text-gray-700 dark:text-gray-200",children:"Email"}),e.jsx(h,{id:"email",type:"email",value:c.email,onChange:a=>u({...c,email:a.target.value}),className:"col-span-3 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"}),(s==null?void 0:s.email)&&e.jsx("p",{className:"col-span-3 col-start-2 text-sm text-red-500 dark:text-red-400",children:s.email})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(d,{htmlFor:"password",className:"text-right text-gray-700 dark:text-gray-200",children:"Contraseña"}),e.jsx(h,{id:"password",type:"password",value:c.password,onChange:a=>u({...c,password:a.target.value}),className:"col-span-3 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"}),(s==null?void 0:s.password)&&e.jsx("p",{className:"col-span-3 col-start-2 text-sm text-red-500 dark:text-red-400",children:s.password})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(d,{htmlFor:"role",className:"text-right text-gray-700 dark:text-gray-200",children:"Rol"}),e.jsxs(O,{value:c.role,onValueChange:a=>u({...c,role:a}),children:[e.jsx(z,{className:"col-span-3 border-gray-300 bg-white dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",children:e.jsx(L,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"cliente",children:"Cliente"}),e.jsx(o,{value:"aliado",children:"Aliado"}),e.jsx(o,{value:"admin",children:"Admin"})]})]}),(s==null?void 0:s.role)&&e.jsx("p",{className:"col-span-3 col-start-2 text-sm text-red-500 dark:text-red-400",children:s.role})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",onClick:()=>C(!1),className:"border-gray-300 dark:border-gray-600 dark:text-gray-200",children:"Cancelar"}),e.jsx(i,{onClick:W,className:"bg-green-600 text-white hover:bg-green-700 dark:bg-green-600 dark:text-white dark:hover:bg-green-700",children:"Crear"})]})]})]}),e.jsx(A,{open:q,onOpenChange:k,children:e.jsxs(D,{className:"rounded-lg bg-white p-6 dark:bg-gray-800 dark:text-gray-100",children:[e.jsx(F,{children:e.jsx(R,{children:"Editar Usuario"})}),t&&e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(d,{htmlFor:"edit-name",className:"text-right text-gray-700 dark:text-gray-200",children:"Nombre"}),e.jsx(h,{id:"edit-name",value:t.name,onChange:a=>p({...t,name:a.target.value}),className:"col-span-3 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(d,{htmlFor:"edit-email",className:"text-right text-gray-700 dark:text-gray-200",children:"Email"}),e.jsx(h,{id:"edit-email",type:"email",value:t.email,onChange:a=>p({...t,email:a.target.value}),className:"col-span-3 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(d,{htmlFor:"edit-role",className:"text-right text-gray-700 dark:text-gray-200",children:"Rol"}),e.jsxs(O,{value:t.role,onValueChange:a=>p({...t,role:a}),children:[e.jsx(z,{className:"col-span-3 border-gray-300 bg-white dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",children:e.jsx(L,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"cliente",children:"Cliente"}),e.jsx(o,{value:"aliado",children:"Aliado"}),e.jsx(o,{value:"admin",children:"Admin"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",onClick:()=>k(!1),className:"border-gray-300 dark:border-gray-600 dark:text-gray-200",children:"Cancelar"}),e.jsx(i,{onClick:Z,className:"bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700",children:"Actualizar"})]})]})}),e.jsx(A,{open:_,onOpenChange:v,children:e.jsxs(D,{className:"max-w-4xl rounded-lg bg-white p-6 dark:bg-gray-800 dark:text-gray-100",children:[e.jsxs(F,{children:[e.jsx(R,{children:"Enviar Correo Masivo"}),e.jsx(ne,{children:"Envía un correo electrónico a los usuarios seleccionados con un asunto y descripción personalizados."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Destinatarios"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(()=>{const a=[...m.map(r=>{const n=j.find(T=>T.id===r);return n?{name:n.name,email:n.email}:null}).filter(Boolean),...S.map(r=>({name:"",email:r}))],g=E?a:a.slice(0,2);return e.jsxs(e.Fragment,{children:[g.map((r,n)=>e.jsx(ie,{variant:"secondary",className:"flex items-center gap-1",children:r.name?`${r.name} <${r.email}>`:r.email},n)),a.length>2&&e.jsx(i,{size:"sm",variant:"outline",onClick:()=>K(!E),className:"text-xs",children:E?"Ver menos":`Ver todos (${a.length-2})`})]})})()})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"email-subject",className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Asunto"}),e.jsx(h,{id:"email-subject",placeholder:"Escribe el asunto del correo...",value:f,onChange:a=>B(a.target.value),className:"mt-1 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"email-description",className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Descripción"}),e.jsx(me,{id:"email-description",placeholder:"Redacta el mensaje que deseas enviar...",value:N,onChange:a=>V(a.target.value),rows:4,className:"mt-1 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Previsualización"}),e.jsx("div",{className:"mt-2 rounded-lg border bg-gray-50 p-4 dark:border-gray-600 dark:bg-gray-700",children:e.jsx("iframe",{srcDoc:re(f,N),className:"w-full rounded border-0",style:{height:"400px"},title:"Email Preview"})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>v(!1),className:"border-gray-300 dark:border-gray-600 dark:text-gray-200",children:"Cancelar"}),e.jsx(i,{onClick:ae,disabled:!f.trim()||!N.trim()||m.length+S.length===0,className:"bg-green-600 text-white hover:bg-green-700 disabled:opacity-50 dark:bg-green-600 dark:text-white dark:hover:bg-green-700",children:"Enviar"})]})]})})]})]}),e.jsx("div",{className:"overflow-hidden rounded-lg bg-white/90 shadow-xl backdrop-blur-sm dark:bg-gray-800/90",children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsxs(H,{className:"bg-gray-50/50 dark:bg-gray-700/50",children:[e.jsx(b,{className:"w-12 rounded-tl-lg",children:e.jsx($,{checked:m.length===x.length&&x.length>0,onCheckedChange:Q,className:"border-gray-300 dark:border-gray-600"})}),e.jsx(b,{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Nombre"}),e.jsx(b,{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Email"}),e.jsx(b,{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Rol"}),e.jsx(b,{className:"w-32 rounded-tr-lg font-semibold text-gray-900 dark:text-gray-100",children:"Acciones"})]})}),e.jsx(ge,{children:x.map(a=>e.jsxs(H,{className:"transition-colors hover:bg-gray-50 dark:hover:bg-gray-700/40",children:[e.jsx(y,{children:e.jsx($,{checked:m.includes(a.id),onCheckedChange:()=>Y(a.id),className:"border-gray-300 hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700/50"})}),e.jsx(y,{className:"font-medium text-gray-900 dark:text-gray-100",children:a.name}),e.jsx(y,{className:"text-gray-700 dark:text-gray-300",children:a.email}),e.jsx(y,{children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium capitalize ${a.role==="admin"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":a.role==="aliado"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"}`,children:a.role})}),e.jsx(y,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>X(a),className:"border-gray-300 hover:bg-gray-50 dark:border-gray-600 dark:hover:bg-gray-700/50",children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>ee(a.id),className:"border-red-300 text-red-600 hover:bg-red-50 dark:border-red-900 dark:text-red-400 dark:hover:bg-red-900/20",children:e.jsx(be,{className:"h-4 w-4"})})]})})]},a.id))})]})}),x.length===0&&e.jsxs("div",{className:"animate-fade-in mt-10 rounded-lg bg-white p-16 text-center text-lg text-gray-600 shadow-sm dark:bg-gray-800 dark:text-gray-400",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-green-100 dark:bg-green-900",children:e.jsx(ye,{className:"h-12 w-12 text-green-600 dark:text-green-300"})}),e.jsx("h3",{className:"mb-2 text-xl font-semibold",children:"No hay usuarios con ese filtro"}),e.jsx("p",{className:"mb-6",children:"Cambia el filtro o crea un nuevo usuario"})]})]})}),e.jsx(le,{})]})}export{Ye as default};
