import{r as n,j as e,K as p,L as g}from"./app-C9a0Z2GV.js";import{T as u}from"./theme-switcher-D1-KvWmV.js";import{L as l}from"./leaflet-src-BNGA5NSi.js";import{A as h}from"./app-layout-BiuVrvCM.js";import"./button-Cd7vGOiK.js";import"./index-wTHh6_rQ.js";import"./index-BT6umcoc.js";import"./createLucideIcon-CDVaj1tW.js";import"./avatar-utils-DC3zEnz9.js";import"./x-CWg9G-ba.js";import"./index-D-6MT3mC.js";import"./avatar-DfpzBFwZ.js";import"./Logo-BWfBvknf.js";import"./LogoWhite-CZ6C_-JM.js";import"./chevron-right-BY3h9dfG.js";delete l.Icon.Default.prototype._getIconUrl;l.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});function f({locations:d,className:c=""}){const o=n.useRef(null),s=n.useRef(null);return n.useEffect(()=>{if(!o.current||s.current)return;const a=l.map(o.current).setView([4.5709,-74.2973],6);return l.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:18}).addTo(a),s.current=a,()=>{s.current&&(s.current.remove(),s.current=null)}},[]),n.useEffect(()=>{if(!s.current||!d.length)return;const a=s.current;if(a.eachLayer(t=>{t instanceof l.Marker&&a.removeLayer(t)}),d.forEach(t=>{const r=Math.max(30,Math.min(50,20+t.count*.5)),i=l.divIcon({html:`
                    <div style="
                        background: #ef4444;
                        color: white;
                        border-radius: 50%;
                        width: ${r}px;
                        height: ${r}px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: bold;
                        font-size: ${Math.max(10,r*.3)}px;
                        border: 3px solid white;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                    ">
                        ${t.count}
                    </div>
                `,className:"custom-marker",iconSize:[r,r],iconAnchor:[r/2,r/2]}),x=l.marker([t.lat,t.lng],{icon:i}).addTo(a),m=`
                <div class="p-2">
                    <h3 class="font-bold text-lg text-gray-800">${t.city}</h3>
                    <p class="text-sm text-gray-600">
                        <strong>${t.count}</strong> mascotas disponibles
                    </p>
                    ${t.shelters?`
                        <p class="text-xs text-gray-500">
                            En ${t.shelters} refugio${t.shelters>1?"s":""}
                        </p>
                    `:""}
                </div>
            `;x.bindPopup(m),x.on("mouseover",function(){this.openPopup()})}),d.length>0){const t=new l.FeatureGroup(d.map(r=>l.marker([r.lat,r.lng])));a.fitBounds(t.getBounds().pad(.1))}},[d]),e.jsx("div",{ref:o,className:`h-96 w-full rounded-lg overflow-hidden shadow-lg ${c}`,style:{minHeight:"400px"}})}const b=[{title:"Mapa",href:"/mapa"}];function S(){const{locations:d,totalMascotas:c,totalCiudades:o}=p().props,[s,a]=n.useState("all"),t=Array.isArray(d)?d:[];return e.jsxs(h,{breadcrumbs:b,children:[e.jsx(g,{title:"Mapa de Adopciones"}),e.jsxs("main",{className:"relative z-0 flex-1 overflow-y-auto bg-gradient-to-r from-green-400 to-blue-500 p-6 dark:from-green-600 dark:to-blue-700",children:[" ",e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-md dark:bg-gray-800",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Mapa de Adopciones"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[c," mascotas en ",o," ciudades"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("select",{value:s,onChange:r=>{a(r.target.value);const i=r.target.value==="all"?"":r.target.value.slice(0,-1);window.location.href=i?`/mapa?especie=${i}`:"/mapa"},className:"rounded-md border border-gray-300 bg-white px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"all",children:"Todas las mascotas"}),e.jsx("option",{value:"perros",children:"Perros"}),e.jsx("option",{value:"gatos",children:"Gatos"}),e.jsx("option",{value:"otros",children:"Otros"})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",children:"Actualizar"})]})]}),e.jsx("div",{className:"mb-6",children:t&&t.length>0?e.jsx(f,{locations:t}):e.jsx("div",{className:"flex h-96 items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No hay datos de ubicación disponibles"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Agrega refugios con ciudades para ver el mapa"})]})})}),t&&t.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-800 dark:text-white",children:"Distribución por Ciudad"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-5",children:t.map(r=>e.jsxs("div",{className:"rounded-lg bg-gray-50 p-4 text-center shadow-sm dark:bg-gray-700",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r.city}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:r.count}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"mascotas"}),r.shelters>0&&e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:[r.shelters," refugio",r.shelters>1?"s":""]})]},r.id))})]}),e.jsx("div",{className:"rounded-lg bg-gradient-to-r from-blue-50 to-green-50 p-4 dark:from-blue-900/20 dark:to-green-900/20",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:c}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total de mascotas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:o}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ciudades con refugios"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:Array.isArray(t)&&t.length>0?t.reduce((r,i)=>r+i.shelters,0):0}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Refugios activos"})]})]})})]})})]}),e.jsx(u,{})]})}export{S as default};
