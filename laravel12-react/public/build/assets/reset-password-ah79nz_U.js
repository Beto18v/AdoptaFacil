import{r as d,j as e,$ as h,L as j,S as v}from"./app-C9a0Z2GV.js";import{I as c}from"./input-error-CeM_PcsI.js";import{T as y}from"./theme-switcher-D1-KvWmV.js";import{B as P}from"./button-Cd7vGOiK.js";import{I as m}from"./input-DOoS4fzs.js";import{L as u}from"./label-CyhaV5PO.js";import{L as N}from"./Logo-BWfBvknf.js";import{L as k}from"./loader-circle-mPGIrds-.js";import"./index-wTHh6_rQ.js";import"./index-BT6umcoc.js";import"./createLucideIcon-CDVaj1tW.js";function O({email:g}){const[s,n]=d.useState({email:g?decodeURIComponent(g):"",token:"",newPassword:"",confirmPassword:""}),[f,l]=d.useState(!1),[t,a]=d.useState({}),[x,p]=d.useState(""),b=async r=>{if(r.preventDefault(),l(!0),a({}),p(""),s.newPassword!==s.confirmPassword){a({confirmPassword:"Las contraseñas no coinciden."}),l(!1);return}if(s.newPassword.length<8){a({newPassword:"La contraseña debe tener al menos 8 caracteres."}),l(!1);return}try{const o=await fetch("http://localhost:8080/api/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s.email,token:s.token,newPassword:s.newPassword,confirmPassword:s.confirmPassword})});let i;const w=o.headers.get("content-type");w&&w.includes("application/json")?i=await o.json():i={message:await o.text()},o.ok?(p("Contraseña actualizada exitosamente."),n({email:"",token:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{v.visit(route("dashboard"))},1500)):o.status===400?i.message?a({general:i.message}):a({general:"Datos inválidos. Verifica la información e intenta de nuevo."}):o.status===500?a({general:"Error interno del servidor. Inténtalo de nuevo."}):a({general:i.message||"Error desconocido. Inténtalo de nuevo."})}catch(o){console.error("Error de conexión:",o),a({general:"Error de conexión. Verifica que el servidor esté ejecutándose."})}finally{l(!1)}};return e.jsxs("div",{className:"flex h-screen items-center justify-center bg-gradient-to-r from-green-400 to-blue-500 dark:from-green-600 dark:to-blue-700",children:[e.jsxs("div",{className:"container w-full max-w-md rounded-lg border border-white/20 bg-white/10 p-5 text-center shadow-lg backdrop-blur-md transition-transform duration-300 ease-in-out hover:scale-[1.005] hover:shadow-xl",children:[e.jsx(h,{href:route("index"),children:e.jsx("img",{src:N,alt:"Logo",className:"mx-auto mb-8 h-36 w-56"})}),e.jsx(j,{title:"Restablecer contraseña"}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Restablecer contraseña"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:"Ingresa el código de 6 dígitos enviado a tu email y tu nueva contraseña."})]}),x&&e.jsx("div",{className:"mb-4 text-center text-sm font-medium text-green-600 dark:text-green-400",children:x}),t.general&&e.jsx("div",{className:"mb-4 text-center text-sm font-medium text-red-600 dark:text-red-400",children:t.general}),e.jsx("form",{className:"flex flex-col gap-6",onSubmit:b,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"email",children:"Correo Electrónico"}),e.jsx(m,{id:"email",type:"email",name:"email",autoComplete:"email",value:s.email,className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none",onChange:r=>n({...s,email:r.target.value}),placeholder:"email@example.com",disabled:!!g}),e.jsx(c,{message:t.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"token",children:"Código de Recuperación"}),e.jsx(m,{id:"token",type:"text",name:"token",value:s.token,className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none",onChange:r=>n({...s,token:r.target.value.replace(/\D/g,"").slice(0,6)}),placeholder:"123456",maxLength:6,autoFocus:!0}),e.jsx(c,{message:t.token})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"newPassword",children:"Nueva Contraseña"}),e.jsx(m,{id:"newPassword",type:"password",name:"newPassword",autoComplete:"new-password",value:s.newPassword,className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none",onChange:r=>n({...s,newPassword:r.target.value}),placeholder:"Ingresa tu nueva contraseña"}),e.jsx(c,{message:t.newPassword})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"confirmPassword",children:"Confirmar Contraseña"}),e.jsx(m,{id:"confirmPassword",type:"password",name:"confirmPassword",autoComplete:"new-password",value:s.confirmPassword,className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none",onChange:r=>n({...s,confirmPassword:r.target.value}),placeholder:"Confirma tu nueva contraseña"}),e.jsx(c,{message:t.confirmPassword})]}),e.jsxs(P,{type:"submit",className:"focus:ring-opacity-50 mt-4 w-full transform rounded-lg bg-blue-500 px-4 py-2 text-white transition-all duration-300 ease-in-out hover:scale-105 hover:bg-blue-600 focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-blue-700 dark:hover:bg-blue-800",disabled:f,children:[f&&e.jsx(k,{className:"h-4 w-4 animate-spin"}),"Restablecer contraseña"]})]})}),e.jsxs("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:[e.jsx("span",{children:"Volver a "}),e.jsx(h,{href:route("login"),className:"text-blue-500 hover:underline dark:text-gray-100",children:"iniciar sesión"})]})]}),e.jsx(y,{})]})}export{O as default};
